<div class="gestion-container">
  <div class="page-header">
    <h2>üìö Gestion des Formations</h2>
    <button class="btn-add" (click)="clickAddFormation()">
      ‚ûï Ajouter une Formation
    </button>
  </div>

  <div class="search-bar">
    <input 
      type="text" 
      [(ngModel)]="searchTerm" 
      (keyup)="filterFormations()" 
      placeholder="üîç Rechercher par titre ou description..."
      class="search-input">
  </div>

  <div class="formations-grid">
    <div class="formation-card" *ngFor="let formation of filteredFormationData">
      <div class="formation-info">
        <h3>{{ formation.titre }}</h3>
        <p class="description">{{ formation.description || 'Aucune description' }}</p>
        <div class="formation-details">
          <span class="badge">‚è±Ô∏è {{ formation.chargeHoraire }}h</span>
          <span class="badge">{{ formation.niveauDifficulte }}</span>
        </div>
        <div class="tags" *ngIf="formation.tags?.length > 0">
          <span class="tag" *ngFor="let tag of formation.tags">{{ tag }}</span>
        </div>
        
        <div class="formation-actions">
          <button class="btn-edit" (click)="onEdit(formation)">
            ‚úèÔ∏è Modifier
          </button>
          <button class="btn-delete" (click)="deleteFormation(formation)">
            üóëÔ∏è Supprimer
          </button>
        </div>
      </div>
    </div>
  </div>

  <div class="no-formations" *ngIf="filteredFormationData?.length === 0">
    <p>üìö Aucune formation trouv√©e</p>
  </div>
</div>

<!-- Modal Formulaire -->
<div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h5 class="modal-title">
        {{showAddButton ? '‚ûï Ajouter une Formation' : '‚úèÔ∏è Modifier la Formation'}}
      </h5>
      <button type="button" class="close-btn" (click)="closeModal()">√ó</button>
    </div>
    
    <div class="modal-body">
      <form [formGroup]="formValue">
        <div class="form-group">
          <label for="titre" class="form-label">Titre *</label>
          <input type="text" class="form-control" id="titre" formControlName="titre" placeholder="Ex: Angular Avanc√©">
        </div>

        <div class="form-group">
          <label for="description" class="form-label">Description</label>
          <textarea class="form-control" id="description" formControlName="description" rows="4" placeholder="Description de la formation..."></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="chargeHoraire" class="form-label">Charge Horaire (heures) *</label>
            <input type="number" class="form-control" id="chargeHoraire" formControlName="chargeHoraire" min="0">
          </div>
          
          <div class="form-group">
            <label for="niveauDifficulte" class="form-label">Niveau de Difficult√© *</label>
            <select class="form-control" id="niveauDifficulte" formControlName="niveauDifficulte">
              <option value="d√©butant">D√©butant</option>
              <option value="interm√©diaire">Interm√©diaire</option>
              <option value="avanc√©">Avanc√©</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="programme" class="form-label">URL du Programme (PDF)</label>
          <input type="url" class="form-control" id="programme" formControlName="programme" placeholder="https://exemple.com/programme.pdf">
        </div>

        <div class="form-group">
          <label for="tags" class="form-label">Tags (s√©par√©s par des virgules)</label>
          <input type="text" class="form-control" id="tags" [(ngModel)]="tagsInput" [ngModelOptions]="{standalone: true}" placeholder="Ex: Angular, TypeScript, Frontend">
        </div>

        <div class="form-group">
          <label class="form-label">Cat√©gories</label>
          <div class="categories-checkboxes">
            <label *ngFor="let categorie of categorieData" class="checkbox-label">
              <input type="checkbox" [checked]="selectedCategories.includes(categorie.id)" (change)="toggleCategory(categorie.id)">
              {{ categorie.nom }}
            </label>
          </div>
        </div>
      </form>
    </div>
    
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="closeModal()">Fermer</button>
      <button type="button" class="btn btn-primary" (click)="postFormationDetails()" *ngIf="showAddButton">
        ‚ûï Ajouter
      </button>
      <button type="button" class="btn btn-warning" (click)="updateFormationDetails()" *ngIf="!showAddButton">
        ‚úèÔ∏è Modifier
      </button>
    </div>
  </div>
</div>
